<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Standard ML notes </title>
  <meta name="description" content="Hugo is a general-purpose website framework. Technically speaking, Hugo is a static site generator. Unlike systems that dynamically build a page with each visitor request, Hugo builds pages when you create or update your content. Since websites are viewed far more often than they are edited, Hugo is designed to provide an optimal viewing experience for your website’s end users and an ideal writing experience for website authors.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Standard ML notes" />
<meta property="og:description" content="Basics Comments (* SML comment *)Variable bindings and Expressions val x = 34;(* static environment: x : int *)(* dynamic environment: x --&gt; 34 *)val y = x &#43; 1;(* Use tilde character instead of minus to reprsent negation *)val z = ~1;(* Integer Division *)val w = y div xStrings:
(* `\n`のようなエスケープシーケンスが利用できる *)val x = &quot;hello\n&quot;; (* 文字列の連結には&#39;^&#39;を使う *)val y = &quot;hello &quot; ^ &quot;world&quot;;An ML program is a sequence of bindings." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/posts/2019-12-30-standardml-notes/" />
<meta property="article:published_time" content="2019-12-30T09:00:00+00:00" />
<meta property="article:modified_time" content="2019-12-30T09:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Standard ML notes"/>
<meta name="twitter:description" content="Basics Comments (* SML comment *)Variable bindings and Expressions val x = 34;(* static environment: x : int *)(* dynamic environment: x --&gt; 34 *)val y = x &#43; 1;(* Use tilde character instead of minus to reprsent negation *)val z = ~1;(* Integer Division *)val w = y div xStrings:
(* `\n`のようなエスケープシーケンスが利用できる *)val x = &quot;hello\n&quot;; (* 文字列の連結には&#39;^&#39;を使う *)val y = &quot;hello &quot; ^ &quot;world&quot;;An ML program is a sequence of bindings."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://example.com/css/style-white.css">
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://example.com/images/favicon.ico" />

  
  
  
</head>
<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://example.com/posts/2019-11-23-uipath-orchestrator/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://example.com/posts/2020-02-29-racket/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&text=Standard%20ML%20notes">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&is_video=false&description=Standard%20ML%20notes">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Standard%20ML%20notes&body=Check out this article: https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&name=Standard%20ML%20notes&description=Basics%20Comments%20%28%2a%20SML%20comment%20%2a%29%0dVariable%20bindings%20and%20Expressions%20val%20x%20%3d%2034%3b%0d%28%2a%20static%20environment%3a%20x%20%3a%20int%20%2a%29%0d%28%2a%20dynamic%20environment%3a%20x%20--%26gt%3b%2034%20%2a%29%0dval%20y%20%3d%20x%20%2b%201%3b%0d%28%2a%20Use%20tilde%20character%20instead%20of%20minus%20to%20reprsent%20negation%20%2a%29%0dval%20z%20%3d%20~1%3b%0d%28%2a%20Integer%20Division%20%2a%29%0dval%20w%20%3d%20y%20div%20x%0dStrings%3a%0a%28%2a%20%60%5cn%60%e3%81%ae%e3%82%88%e3%81%86%e3%81%aa%e3%82%a8%e3%82%b9%e3%82%b1%e3%83%bc%e3%83%97%e3%82%b7%e3%83%bc%e3%82%b1%e3%83%b3%e3%82%b9%e3%81%8c%e5%88%a9%e7%94%a8%e3%81%a7%e3%81%8d%e3%82%8b%20%2a%29%0dval%20x%20%3d%20%26quot%3bhello%5cn%26quot%3b%3b%20%28%2a%20%e6%96%87%e5%ad%97%e5%88%97%e3%81%ae%e9%80%a3%e7%b5%90%e3%81%ab%e3%81%af%27%5e%27%e3%82%92%e4%bd%bf%e3%81%86%20%2a%29%0dval%20y%20%3d%20%26quot%3bhello%20%26quot%3b%20%5e%20%26quot%3bworld%26quot%3b%3b%0dAn%20ML%20program%20is%20a%20sequence%20of%20bindings.">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&t=Standard%20ML%20notes">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#basics">Basics</a>
      <ul>
        <li><a href="#comments">Comments</a></li>
        <li><a href="#variable-bindings-and-expressions">Variable bindings and Expressions</a></li>
        <li><a href="#shadowing">Shadowing</a></li>
        <li><a href="#function-bindings">Function Bindings</a></li>
        <li><a href="#pairs-and-other-tuples">Pairs and other Tuples</a></li>
        <li><a href="#lists">Lists</a></li>
        <li><a href="#list-functions">List Functions</a></li>
        <li><a href="#let-expressions">Let Expressions</a></li>
        <li><a href="#options">Options</a></li>
      </ul>
    </li>
    <li><a href="#some-more-expressions">Some More Expressions</a></li>
    <li><a href="#build-new-types">Build New Types</a>
      <ul>
        <li><a href="#records">Records</a></li>
        <li><a href="#datatype-bindings">Datatype bindings</a></li>
      </ul>
    </li>
    <li><a href="#case-expressions">Case Expressions</a></li>
    <li><a href="#lists-and-options-are-datatypes-too">Lists and Options are Datatypes too</a></li>
    <li><a href="#pattern-matching">Pattern-matching</a>
      <ul>
        <li><a href="#function-patterns">Function Patterns</a></li>
      </ul>
    </li>
    <li><a href="#exceptions">Exceptions</a></li>
    <li><a href="#tail-recursion">Tail Recursion</a></li>
    <li><a href="#first-class-functions">First-class Functions</a>
      <ul>
        <li><a href="#anonymous-functions">Anonymous Functions</a></li>
        <li><a href="#lexical-scope-vs-dynamic-scope">Lexical scope VS dynamic scope</a></li>
        <li><a href="#combining-functions">Combining Functions</a></li>
        <li><a href="#currying">Currying</a></li>
      </ul>
    </li>
    <li><a href="#type-inference">Type Inference</a>
      <ul>
        <li><a href="#value-restriction">Value restriction</a></li>
      </ul>
    </li>
    <li><a href="#mutual-recursion">Mutual Recursion</a></li>
    <li><a href="#modules">Modules</a>
      <ul>
        <li><a href="#signatures">Signatures</a></li>
        <li><a href="#signature-matching">Signature matching</a></li>
      </ul>
    </li>
    <li><a href="#equivalence">Equivalence</a></li>
  </ul>
</nav>
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Standard ML notes
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2019-12-30 09:00:00 &#43;0000 UTC" itemprop="datePublished">2019-12-30</time>
          
        </div>
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/notes">notes</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/sml" rel="tag">SML</a>
            
        </div> 
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      <h2 id="basics">Basics</h2>
<h3 id="comments">Comments</h3>
<pre><code class="language-ML" data-lang="ML">(* SML comment *)
</code></pre><h3 id="variable-bindings-and-expressions">Variable bindings and Expressions</h3>
<pre><code class="language-ML" data-lang="ML">val x = 34;
(* static environment: x : int *)
(* dynamic environment: x --&gt; 34 *)
val y = x + 1;

(* Use tilde character instead of minus to reprsent negation *)
val z = ~1;

(* Integer Division *)
val w = y div x
</code></pre><p>Strings:</p>
<pre><code class="language-ML" data-lang="ML">(* `\n`のようなエスケープシーケンスが利用できる *)
val x = &quot;hello\n&quot;; 
(* 文字列の連結には'^'を使う *)
val y = &quot;hello &quot; ^ &quot;world&quot;;
</code></pre><p>An ML program is a sequence of bindings. Each binding gets <strong>type-checked</strong> and then <strong>evaluated</strong>. 
What type a binding has depends on a static environment. How a binding is evaluated depends on a dynamic environment.
Sometimes we use just <code>environment</code> to mean dynamic environment and use <code>context</code> as a synonym for static environment.</p>
<ul>
<li>Syntaxs : How to write it.</li>
<li>Semantics: How it type-checks and evaluates</li>
<li>Value: an expression that has no more computation to do</li>
</ul>
<h3 id="shadowing">Shadowing</h3>
<p><strong>Bindings are immutable</strong> in SML. Given <code>val x = 8 + 9;</code> we produce a dynamic environment where x maps to 17. 
In this environment x will always map to 17; there is no &ldquo;assignment statement&rdquo; in ML for changing what x maps to. 
You can have another binding later, say <code>val x = 19;</code>, but that just creates a differnt environment 
where the later binding for x <strong>shadows</strong> the earlier one.</p>
<h3 id="function-bindings">Function Bindings</h3>
<pre><code class="language-ML" data-lang="ML">fun pow (x:int, y:int) = (* correct only for y &gt;= 0 *)
    if y = 0
    then 1
    else x * pow(x, y-1);

fun cube (x : int) = 
    pow(x, 3);

val ans = cube(4);
(* The parentheses are not necessary if there is only one argument
     val ans = cube 4; *)
</code></pre><ul>
<li>Syntax: <code>fun x0 (x1 : t1, ..., xn : tn) = e</code></li>
<li>Type-checking:
<ul>
<li><code>t1 * ... * tn -&gt; t</code></li>
<li>The type of a function is &ldquo;argument types&rdquo; -&gt; &ldquo;reslut types&rdquo;</li>
</ul>
</li>
<li>Evaluation:
<ul>
<li>A function is a value</li>
<li>The environment we extends arguments with is that “was current” when the function was defined, not the one where it is being called.</li>
</ul>
</li>
</ul>
<h3 id="pairs-and-other-tuples">Pairs and other Tuples</h3>
<pre><code class="language-ML" data-lang="ML">fun swap (pr : int*bool) =
    (#2 pr, #1 pr);

fun sum_two_pairs (pr1 : int * int, pr2 : int * int) =
    (#1 pr1) + (#2 pr1 ) + (#1 pr2) + (#2 pr2);

fun div_mod (x : int, y: int) =
    (x div y, x mod y);

fun sort_pair(pr : int * int) =
    
    if (#1 pr) &lt; (#2 pr) then
	pr
    else
	(#2 pr, #1 pr);
</code></pre><p>ML supportstuplesby allowing any number of parts. Pairs and tuples can be nested however you want. For example, a 3-tuple (i.e., a triple) of integers has type int<em>int</em>int. An example is (7,9,11) and you retrieve the parts with #1 e, #2 e, and #3 e where e is an expression that evaluates to a triple.</p>
<pre><code class="language-ML" data-lang="ML">val a = (7, 9, 11) (* int * int * int *)
val x = (3, (4, (5,6))); (* int * (int * (int * int)) *)
val y = (#2 x, (#1 x, #2 (#2 x))); (* (int * (int * int)) * (int * (int * int)) *)
val ans = (#2 y, 4); (* (int * (int * int)) * int *)
</code></pre><h3 id="lists">Lists</h3>
<pre><code class="language-ML" data-lang="ML">val x = [7,8,9];
5::x; (* 5 consed onto x *)
6::5::x;
[6]::[[1,2],[3,4];
</code></pre><p>To append a list t a list, use list-append operator <code>@</code>:
<a href="%5Bhttp://sml-family.org/Basis/list.html%5D(http://sml-family.org/Basis/list.html)">Reference：# The Standard ML Basis Library</a></p>
<blockquote>
<p>Interface:
<strong>val</strong>  <a href="http://sml-family.org/Basis/list.html#SIG:LIST.@:VAL">@</a>  <strong>:</strong>  <em>&lsquo;a</em> list *  <em>&lsquo;a</em> list <strong>-&gt;</strong>  <em>&lsquo;a</em> list</p>
</blockquote>
<pre><code>val x = [1,2] @ [3,4,5]; (* [1,2,3,4,5] *)
</code></pre><p>Accessing:</p>
<pre><code class="language-ML" data-lang="ML">val x = [7,8,9];
null x; (* False *)
null []; (* True *)
hd x; (* 7 *)
tl x; (* [8, 9] *)
</code></pre><h3 id="list-functions">List Functions</h3>
<pre><code class="language-ML" data-lang="ML">fun sum_list(xs : int list) =
    if null xs
    then 0
    else hd xs + sum_list(tl xs);

fun list_product(xs : int list) =
    if null xs
    then 1
    else hd xs * list_product(tl xs);

fun countdown(x : int) =
    if x = 0
    then []
    else x :: countdown(x - 1);

fun append (xs : int lisst, ys : int list) =
    if null xs
    then ys
    else (hd xs) :: append((tl xs), ys);

fun sum_pair_list(xs : (int * int) list) =
    if null xs
    then 0
    else #1 (hd xs) + #2 (hd xs) + sum_pair_list(tl xs);

fun firsts (xs : (int * int) list) =
    if null xs
    then []
    else (#1 (hd xs)) :: firsts(tl xs);

fun seconds (xs : (int * int) list) =
    if null xs
    then []
    else (#2 (hd xs)) :: seconds(tl xs);

fun sum_pair_list2 (xs : (int * int) list) =
    (sum_list(firsts xs)) + (sum_list(seconds xs));

</code></pre><p>Functions that make and us lists are almost always recursice becasue a list has an unknown length. To write a recursive function the thought process involves two steps:</p>
<ul>
<li>think about the <em>base case</em></li>
<li>think about the <em>recursive case</em></li>
</ul>
<h3 id="let-expressions">Let Expressions</h3>
<ul>
<li>Syntax: <code>let b1 b2 ... bn in e end</code>
<ul>
<li>Each <code>bi</code> is any binding an <code>e</code> is any expression</li>
</ul>
</li>
</ul>
<pre><code class="language-ML" data-lang="ML">let val x = 1
in
    (let val x = 2 in x+1 end) + (let val y = x+2 in y+1 end)
end

fun countup_from1 (x:int) =
    let fun count (from:int) =
        if from=x
        then x::[]
        else from :: count(from+1)
    in
        count(1)
    end
</code></pre><h3 id="options">Options</h3>
<p>An option value has either 0 or 1 thing: <code>None</code> is an option value carrying nothing whereas <code>SOME e</code> evaluates e to a value v and becomes the option carrying the one value v. The type of <code>NONE</code> is <code>'a option</code> and the type of <code>SOME e</code> is <code>t option</code> if e has type t.</p>
<p>We have:</p>
<ul>
<li><code>isSome</code> which evaluates to false if its argument is NONE</li>
<li><code>valOf</code> to get the value carried by <code>SOME</code>(raising exception for <code>NONE</code>)</li>
</ul>
<pre><code class="language-ML" data-lang="ML">fun max1( xs : int list) =
    if null xs
    then NONE
    else
	let val tl_ans = max1(tl xs)
	in
	    if isSome tl_ans andalso valOf tl_ans &gt; hd xs
	    then tl_ans
	    else SOME (hd xs)
	end;
</code></pre><h2 id="some-more-expressions">Some More Expressions</h2>
<p>Boolean operations:</p>
<ul>
<li><code>e1 andalso e2</code>
<ul>
<li>if result of e1 is false then false else result of e2</li>
</ul>
</li>
<li><code>e1 orelse e2</code></li>
<li><code>not e1</code></li>
</ul>
<p><strong>※Syntax <code>&amp;&amp;</code> and <code>||</code> don&rsquo;t exist in ML and <code>!</code> means something different.</strong></p>
<p><strong>※<code>andalso</code> and <code>orelse</code> are just keywords. <code>not</code> is a pre-defined function.</strong></p>
<p>Comparisons:</p>
<ul>
<li><code>=</code> <code>&lt;&gt;</code> <code>&gt;</code> <code>&lt;</code> <code>&gt;=</code> <code>&lt;=</code>
<ul>
<li><code>=</code> and <code>&lt;&gt;</code> can be used with any &ldquo;equality type&rdquo; but not with real</li>
</ul>
</li>
</ul>
<h2 id="build-new-types">Build New Types</h2>
<p>To Create a compound type, there are really only three essential building blocks:</p>
<ul>
<li><strong>Each-of</strong> : A compound type t describes values that contain each of values of type <code>t1</code> <code>t2</code> &hellip; <code>tn</code></li>
<li><strong>One-of</strong>: A compound type t describes values that contain a value of one of the types <code>t1</code> <code>t2</code> &hellip; <code>tn</code></li>
<li><strong>Self-refenence</strong>: A compound type t may refer to itself in its definition in order to describe recursive data structures like lists and trees.</li>
</ul>
<h3 id="records">Records</h3>
<p>Record types are &ldquo;each-of&rdquo; types where each component is a named field. The order of fields never matters.</p>
<pre><code class="language-ML" data-lang="ML">val x = {bar = (1+2,true andalso true), foo = 3+4, baz = (false,9) }
#bar x (* (3, true) *)
</code></pre><p>Tupels are actually syntactic sugar for records. <code>#1 e</code>, <code>#2 e</code>, etc. mean: get the contents of the field named 1, 2, etc.</p>
<pre><code class="language-ML" data-lang="ML">- val x = {1=&quot;a&quot;,2=&quot;b&quot;};
val x = (&quot;a&quot;,&quot;b&quot;) : string * string
- val y = {1=&quot;a&quot;, 3=&quot;b&quot;};
val y = {1=&quot;a&quot;,3=&quot;b&quot;} : {1:string, 3:string}
</code></pre><h3 id="datatype-bindings">Datatype bindings</h3>
<pre><code class="language-ML" data-lang="ML">datatype mytype = TwoInts of int*int
		                       | Str of string
                               | Pizza;
val a = Str &quot;hi&quot;; (* Str &quot;hi&quot; : mytype *)
val b = Str; (* fn : string -&gt; mytype *)
val c = Pizza; (* Pizza : mytype *)
val d = TwoInts(1+2, 3+4); (* TwoInts (3,7) : mytype *)
val e = a; (* Str &quot;hi&quot; : mytype *)
</code></pre><p>The example above adds four things to the environment:</p>
<ul>
<li>A new type mytype that we can now use just like any other types</li>
<li>Three constructors <code>TwoInts</code>, <code>Str</code>, <code>Pizza</code></li>
</ul>
<p>We can also create a type synonmy which is entirely interchangeable with the existing type.</p>
<pre><code class="language-ML" data-lang="ML">type foo = int
(* we can write foo wherever we write int and vice-versa *)
</code></pre><h2 id="case-expressions">Case Expressions</h2>
<p>To access to datatype values, we can use a case expression:</p>
<pre><code class="language-ML" data-lang="ML">fun f (x : mytype) =
    case x of
	    Pizza =&gt; 3
      | Str s =&gt; 8
      | TwoInts(i1, i2) =&gt; i1 + i2;

f(Str(&quot;a&quot;)); (* val it = 8 : int *)
</code></pre><p>We separate the branches with the <code>|</code> character. Each branch has the form <code>p =&gt; e</code> where p is a pattern and e is an expression. Patterns are used to match against the result of evaluating the case&rsquo;s first expression. This is why evaluating a case-expression is called pattern-matching.</p>
<h2 id="lists-and-options-are-datatypes-too">Lists and Options are Datatypes too</h2>
<p><code>SOME</code> and <code>NONE</code> are actually constructors. So you can use them in a case like:</p>
<pre><code class="language-ML" data-lang="ML">fun inc_or_zero intoption =
    case intoption of
	    NONE =&gt; 0
      | SOME i =&gt; i+1;
</code></pre><p>As for list, <code>[]</code> and <code>::</code> are also constructors. <code>::</code> is a little unusual because it is an infix operator so when in patterns:</p>
<pre><code class="language-ML" data-lang="ML">fun sum_list xs =
    case xs of
	    [] =&gt; 0
      | x::xs' =&gt; x + sum_list xs';

fun append(xs, ys) =
    case xs of
	    [] =&gt; ys
      | x::xs' =&gt; x :: append(xs', ys);
</code></pre><h2 id="pattern-matching">Pattern-matching</h2>
<p>Val-bindings are actually using pattern-matching.</p>
<pre><code class="language-ML" data-lang="ML">val (x, y, z) = (1,2,3);
(*
    val x = 1 : int
    val y = 2 : int
    val z = 3 : int
*)
</code></pre><p>When defining a function, we can also use pattern-matching</p>
<pre><code class="language-ML" data-lang="ML">fun sum_triple (x, y, z) =
    x + y + z;
</code></pre><p>Actually, all functions in ML takes one tripple as an argument. There is no such thing as a mutli-argument function  or zero-argument function in ML.
The binding <code>fun () = e</code> is using the unit-pattern <code>()</code> to match against calls that pass the unit value <code>()</code>, which is the only value fo a pre-defined datatype <code>unit</code>.</p>
<p>The definition of patterns is recursive. We can use nested patterns instead of nested cae expressions.</p>
<p>We can use wildcard pattern <code>_</code> in patterns.</p>
<pre><code class="language-ML" data-lang="ML">fun len xs =
    case xs of
	[] =&gt; 0
      | _::xs' =&gt; 1 + len xs';

</code></pre><h3 id="function-patterns">Function Patterns</h3>
<p>In a function binding, we can use a syntactic sugar instead of using case expressions:</p>
<pre><code class="language-ML" data-lang="ML">fun f p1 = e1
  | f p2 = e2
  ...
  | f pn = en
</code></pre><p>for example</p>
<pre><code class="language-ML" data-lang="ML">fun append ([], ys) = ys
  | append (x::xs', ys) = x :: append(xs', ys);
</code></pre><h2 id="exceptions">Exceptions</h2>
<p>To create new kinds of exceptions we can use exception bindings.</p>
<pre><code class="language-ML" data-lang="ML">exception MyUndesirableCondition;
exception MyOtherException of int * int;
</code></pre><p>Use <code>raise</code> to raise exceptions. Use <code>handle</code> to catch exceptions.</p>
<pre><code class="language-ML" data-lang="ML">fun hd xs =
    case xs of
	[] =&gt; raise List.Empty
      | x::_ =&gt; x;

(* The type of maxlist will be int list * exn -&gt; int *)
fun maxlist(xs, ex) =
    case xs of
	[] =&gt; raise ex
      | x::[] =&gt; x
      | x::xs' =&gt; Int.max(x, maxlist(xs', ex));

(* e1 handle ex =&gt; e2 *)
val y = maxlist([], MyUndesirableCondition)
	handle MyUndesirableCondition =&gt; 42;
</code></pre><h2 id="tail-recursion">Tail Recursion</h2>
<p>There is a situation in a recursive call called <strong>tail call</strong>:</p>
<blockquote>
<p>when f makes a recursive call to f, there is nothing more for the caller to do after the callee returns except return the callee&rsquo;s result.</p>
</blockquote>
<p>Consider a sum function:</p>
<pre><code class="language-ML" data-lang="ML">fun sum1 xs =
    case xs of
        [] =&gt; 0
      | i::xs' =&gt; i + sum1 xs'
</code></pre><p>When the function runs, it will keep a call-stack for each recursive call . But if we change a little bit using tail call :</p>
<pre><code class="language-ML" data-lang="ML">fun sum2 xs =
    let fun f (xs,acc) =
        case xs of
            [] =&gt; acc
          | i::xs' =&gt; f(xs',i+acc)
    in
        f(xs,0)
    end
</code></pre><p>we use a local helper <code>f</code> and a accumulator <code>acc</code> so that the return value  of <code>f</code>  is just the return value of <code>sum2</code> . As a result, there is no need to keep every call in stack, just the current <code>f</code> is enough. And that&rsquo;s ML and most of other functional programming languages do.
Another example: when reversing a list:</p>
<pre><code class="language-ML" data-lang="ML">fun rev1 lst =
    case lst of
        [] =&gt; []
      | x::xs =&gt; (rev1 xs) @ [x]

fun rev2 lst =
    let fun aux(lst,acc) =
	    case lst of
		[] =&gt; acc
	      | x::xs =&gt; aux(xs, x::acc)
    in
	aux(lst,[])
    end
</code></pre><p><code>rev1</code> is <code>O(n^2)</code> but rev2 is almost as simple as <code>O(n)</code>.</p>
<p>To make sure which calls are tail calls, we can use a recursive defination of <strong>tail position</strong> like:</p>
<ul>
<li>In <code>fun f(x) = e</code>, <code>e</code> is in tail position.</li>
<li>If an expression is not in tail position, then none of its subexpressions are</li>
<li>If <code>if e1 then e2 else e3</code> is in tail position, then <code>e2</code> and <code>e3</code> are in tail position (but not <code>e1</code>). (Case-expressions are similar.)</li>
<li>If <code>let b1 ... bn in e end</code> is in tail position, then e is in tail position (but no expressions in the bindings are).</li>
<li>Function-call arguments are not in tail position.</li>
</ul>
<h2 id="first-class-functions">First-class Functions</h2>
<p>The most common use of first class functions is passing them as arguments to other functions.</p>
<pre><code class="language-ML" data-lang="ML">fun n_times (f, n, x) =
    if n=0
    then x
    else f (n_times(f, n-1,x))
</code></pre><p>The function <code>n_times</code> is called higher-order funciton.  Its type is:</p>
<pre><code class="language-ML" data-lang="ML">fn : ('a -&gt; 'a) * int * 'a -&gt; 'a
</code></pre><p><code>'a</code> means they can be any type. This is called <em>parametric polymorphism</em> , or <em>generic types</em> .</p>
<p>Instead, consider a function that is not polymorphic:</p>
<pre><code class="language-ML" data-lang="ML">(* (int -&gt; int) * int -&gt; int *)
fun times_until_zero (f, x) =
    if x = 0
    then 0
    else 1 + times_until_zero(f, f x)
</code></pre><h3 id="anonymous-functions">Anonymous Functions</h3>
<pre><code class="language-ML" data-lang="ML">fun triple_n_times (n, x) =
    n_times((fn x =&gt; 3*x), n, x)
</code></pre><p>Maps:</p>
<pre><code class="language-ML" data-lang="ML">(* ('a -&gt; 'b) * 'a list -&gt; 'b list *)
fun map (f, xs) =
    case xs of
	[] =&gt; []
      | x::xs' =&gt; (f x)::(map(f, xs'));
</code></pre><p>Filters:</p>
<pre><code class="language-ML" data-lang="ML">(* ('a -&gt; bool) * 'a list -&gt; 'a list *)
fun filter (f, xs) =
    case xs of
	[] =&gt; []
      | x::xs' =&gt; if f x
		  then x::(filter (f, xs'))
		  else filter (f, xs');
</code></pre><h3 id="lexical-scope-vs-dynamic-scope">Lexical scope VS dynamic scope</h3>
<h3 id="combining-functions">Combining Functions</h3>
<pre><code class="language-ML" data-lang="ML"> fun sqrt_of_abs i = (Math.sqrt o Real.fromInt o abs) i;
</code></pre><p>Use our own infix operator to define a left-to-right syntax.</p>
<pre><code class="language-ML" data-lang="ML">infix |&gt;
fun x |&gt; f = f x;
fun sqrt_of_abs i = i |&gt; abs |&gt; Real.fromInt |&gt; Math.sqrt;
</code></pre><h3 id="currying">Currying</h3>
<pre><code class="language-ML" data-lang="ML">(* fun sorted(x, y z) = z &gt;= y andalso y &gt;= x *)
val sorted = fn x =&gt; fn y =&gt; fn z =&gt; z &gt;= y andalso y &gt;= x;

(* just syntactic sugar for code above *)
fun sorted_nicer x y z = z &gt;= y andalso y &gt;= x;
</code></pre><p>when calling curried the function:</p>
<pre><code class="language-ML" data-lang="ML">(* ((sorted_nicer x) y) z *)
(* or just: *)
sorted_nicer x y z
</code></pre><pre><code class="language-ML" data-lang="ML">
</code></pre><h2 id="type-inference">Type Inference</h2>
<p>Key steps in ML:</p>
<ul>
<li>Determine types of bindings in order</li>
<li>For each val of fun binding:
<ul>
<li>Analyze definition for all necessary facts</li>
<li>Type erro if no way for all facts to hold</li>
</ul>
</li>
<li>Use type variables like <code>'a</code> for any unconstrained type</li>
<li>Enforce the value restriction</li>
</ul>
<p>One example:</p>
<pre><code class="language-ML" data-lang="ML">(*
	compose : T1 * T2 -&gt; T3
	f : T1
	g : T2
	x : T4
	body being a function has type T3=T4-&gt;T5
	from g being passed x, T2=T4-&gt;T6 for some T6
	from f being passed the result of g, T1=T6-&gt;T7
	from call to f being body of anonymous function, T7 = T5
	all together, (T6-&gt;T5) * (T4-&gt;T6) -&gt; (T4-&gt;T5)
	so ('a-&gt;'b) * ('c-&gt;'a) -&gt; ('c-&gt;'b) 
*)
fun compose (f, g) = fn x =&gt; f (g x)
</code></pre><h3 id="value-restriction">Value restriction</h3>
<p>A variable-binding can have a polymorphic type only if the expression is a variable or value:</p>
<pre><code class="language-ML" data-lang="ML">val r = ref NONE
val _ = r := SOME &quot;hi&quot;
val i - 1 + valOf (!r)
</code></pre><p>If there is is no value-restriction, the code above will type check, which shouldn&rsquo;t.
With value restriction, ML will give a warning when type-checking:</p>
<pre><code>- val r = ref NONE;
stdIn:2.5-2.17 Warning: type vars not generalized because of
   value restriction are instantiated to dummy types (X1,X2,...)
val r = ref NONE : ?.X1 option ref
</code></pre><h2 id="mutual-recursion">Mutual Recursion</h2>
<p>Mutual recursion allows <code>f</code> to call <code>g</code> and <code>g</code> to call <code>f</code>.
In ML, There is an <code>and</code> keyword to allow that:</p>
<pre><code class="language-ML" data-lang="ML">fun p1 = e1
and p2 = e2
and p3 = p3
</code></pre><h2 id="modules">Modules</h2>
<pre><code class="language-ML" data-lang="ML">structure MyMathLib =
struct
fun fact x = x
val half_pi = Math.pi / 2.0
fun doubler x = x * 2
end
</code></pre><h3 id="signatures">Signatures</h3>
<p>A signature is a type for a module.</p>
<pre><code class="language-ML" data-lang="ML">signature SIGNAME  =
sig types-for-bindings
end
</code></pre><p>Ascribing a signature to a module:</p>
<pre><code class="language-ML" data-lang="ML">structure myModule :&gt; SIGNAME =
struct bindings end;
</code></pre><p>Anything not in the signature cannot be used outside the module.</p>
<pre><code class="language-ML" data-lang="ML">signature MATHLIB =
sig
    val fact : int -&gt; int
    val half_pi : real
    (* make doubler unaccessable outside the MyMathLib *)
    (* val doubler : int -&gt; int *)
end

structure MyMathLib :&gt; MATHLIB =
struct
fun fact x = x
val half_pi = Math.pi / 2.0
fun doubler x = x * 2
end 
</code></pre><h3 id="signature-matching">Signature matching</h3>
<h2 id="equivalence">Equivalence</h2>
<ul>
<li>PL Equivalence</li>
<li>Asymptotic equivalence</li>
<li>System equivalence</li>
</ul>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Writings</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#basics">Basics</a>
      <ul>
        <li><a href="#comments">Comments</a></li>
        <li><a href="#variable-bindings-and-expressions">Variable bindings and Expressions</a></li>
        <li><a href="#shadowing">Shadowing</a></li>
        <li><a href="#function-bindings">Function Bindings</a></li>
        <li><a href="#pairs-and-other-tuples">Pairs and other Tuples</a></li>
        <li><a href="#lists">Lists</a></li>
        <li><a href="#list-functions">List Functions</a></li>
        <li><a href="#let-expressions">Let Expressions</a></li>
        <li><a href="#options">Options</a></li>
      </ul>
    </li>
    <li><a href="#some-more-expressions">Some More Expressions</a></li>
    <li><a href="#build-new-types">Build New Types</a>
      <ul>
        <li><a href="#records">Records</a></li>
        <li><a href="#datatype-bindings">Datatype bindings</a></li>
      </ul>
    </li>
    <li><a href="#case-expressions">Case Expressions</a></li>
    <li><a href="#lists-and-options-are-datatypes-too">Lists and Options are Datatypes too</a></li>
    <li><a href="#pattern-matching">Pattern-matching</a>
      <ul>
        <li><a href="#function-patterns">Function Patterns</a></li>
      </ul>
    </li>
    <li><a href="#exceptions">Exceptions</a></li>
    <li><a href="#tail-recursion">Tail Recursion</a></li>
    <li><a href="#first-class-functions">First-class Functions</a>
      <ul>
        <li><a href="#anonymous-functions">Anonymous Functions</a></li>
        <li><a href="#lexical-scope-vs-dynamic-scope">Lexical scope VS dynamic scope</a></li>
        <li><a href="#combining-functions">Combining Functions</a></li>
        <li><a href="#currying">Currying</a></li>
      </ul>
    </li>
    <li><a href="#type-inference">Type Inference</a>
      <ul>
        <li><a href="#value-restriction">Value restriction</a></li>
      </ul>
    </li>
    <li><a href="#mutual-recursion">Mutual Recursion</a></li>
    <li><a href="#modules">Modules</a>
      <ul>
        <li><a href="#signatures">Signatures</a></li>
        <li><a href="#signature-matching">Signature matching</a></li>
      </ul>
    </li>
    <li><a href="#equivalence">Equivalence</a></li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&text=Standard%20ML%20notes">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&is_video=false&description=Standard%20ML%20notes">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Standard%20ML%20notes&body=Check out this article: https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&title=Standard%20ML%20notes">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&name=Standard%20ML%20notes&description=Basics%20Comments%20%28%2a%20SML%20comment%20%2a%29%0dVariable%20bindings%20and%20Expressions%20val%20x%20%3d%2034%3b%0d%28%2a%20static%20environment%3a%20x%20%3a%20int%20%2a%29%0d%28%2a%20dynamic%20environment%3a%20x%20--%26gt%3b%2034%20%2a%29%0dval%20y%20%3d%20x%20%2b%201%3b%0d%28%2a%20Use%20tilde%20character%20instead%20of%20minus%20to%20reprsent%20negation%20%2a%29%0dval%20z%20%3d%20~1%3b%0d%28%2a%20Integer%20Division%20%2a%29%0dval%20w%20%3d%20y%20div%20x%0dStrings%3a%0a%28%2a%20%60%5cn%60%e3%81%ae%e3%82%88%e3%81%86%e3%81%aa%e3%82%a8%e3%82%b9%e3%82%b1%e3%83%bc%e3%83%97%e3%82%b7%e3%83%bc%e3%82%b1%e3%83%b3%e3%82%b9%e3%81%8c%e5%88%a9%e7%94%a8%e3%81%a7%e3%81%8d%e3%82%8b%20%2a%29%0dval%20x%20%3d%20%26quot%3bhello%5cn%26quot%3b%3b%20%28%2a%20%e6%96%87%e5%ad%97%e5%88%97%e3%81%ae%e9%80%a3%e7%b5%90%e3%81%ab%e3%81%af%27%5e%27%e3%82%92%e4%bd%bf%e3%81%86%20%2a%29%0dval%20y%20%3d%20%26quot%3bhello%20%26quot%3b%20%5e%20%26quot%3bworld%26quot%3b%3b%0dAn%20ML%20program%20is%20a%20sequence%20of%20bindings.">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fexample.com%2fposts%2f2019-12-30-standardml-notes%2f&t=Standard%20ML%20notes">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2020  You 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Writings</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/js/main.js"></script>



</html>
